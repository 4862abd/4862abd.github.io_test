1장. 쏙쏙들어오는 함수형 코딩에 오신 것을 환영합니다.

※※ 함수형 프로그래밍은 무엇인가요?
사전적 의미의 함수형 프로그래밍(Functional Programming, FP, 명사)을 설명한다고 한다.
	ㄴ 수학 함수를 사용하고 부수 효과(Side Effect)를 피하는 것이 특징인 프로그래밍 패러다임
	ㄴ 부수 효과 없이 순수 함수(Pure Function)만 사용하는 프로그래밍 스타일

여기서 부수 효과(Side Effect)는 함수가 값을 리턴하는 이외의 모든 일을 뜻한다고 한다.
책에서는 예시로 자동차의 브레이크 패드의 동작으로 자동차가 제동이 걸리는 것을 삼았다.
자동차가 멈추기 위해 브레이크 패드가 바퀴에 맞물려 동작하는 것이 리턴값이라면, 패달을 밟는 것이 부수 효과라고 한다.
즉, 사전적 의미에서 함수형 프로그래밍을 위해서 브레이크 패드가 동작할 때, 다른 행동인 패달을 밟는 것은 피해야하는 부수 효과 라는 것이다.

하지만 이상하다.
패달을 밟지 않고 어떻게 브레이크를 동작시키지?
자동화하여 사람이 밟지 않고 센서가 동작 시킨다고 해도 결국 센서가 인식하고 제동 센서를 활성화하여 브레이크에 명령(메세지)가 전달되기 전까지는 모두 부수 효과일 것이다.

순수 함수 또한 마찬가지이다.
인자에만 의존하고 부수 효과가 없는 덕에 같은 값을 넣으면 항상 같은 리턴이 돌아오는 성질이 수학과 비슷하다고 하여 수학 함수 라고 불리는 순수 함수또한 브레이크 센서와 비교하면
언제 센서가 인지하고 어느 거리에서 제동할지 인자값 등이 같다고 해도 브레이크 패드의 마모 등으로 동작은 했지만 리턴이 다를 수 있다.
같은 값을 넣었다고 브레이크는 동작 하겠지만 리턴이 항상 같을 수는 없다는 뜻이다.


즉, 브레이크가 동작한다 는 상황은 부수 효과를 동반하고, 순수하지 못한 함수로 동작하게 될 것이라는 것을 의미한다.

※※ 실용적인 측면에서 함수형 프로그래밍 정의의 문제점
그래서 이 책에서는 이렇게 설명한다.
실용적인 측면에서의 함수형 프로그래밍 정의의 문제점 이라고.
ㄴ 01. 부수 효과는 필요하다. -> 위의 설명에서 브레이크를 동작하기 위해 밟는 패달이나 선서 설명 등을 통해 공감한다.
ㄴ 02. 함수형 프로그래밍은 부수 효과를 효과적으로 다룰 수 있다. -> 함수형 프로그래밍의 정의처럼 순수 함수만을 이용하는 것이 아니고, 
순수하지 않은 함수를 효과적으로 다룰 방법이 많다고 한다.
ㄴ 03. 함수형 프로그래밍은 실용적이다. -> 수학처럼 정의되어 실용적이지 않게 보이지만 효과적인 프로그램이 많다. -> 이 부분은 나중에 설명이 더 나올 듯 하다.


※※ 액션과 계산, 데이터 구분하기
즉, 우리는 함수형 프로그래밍을 "정의"하지 말고, 기술적인 측면에서 재해석을 해야한다고 한다.
이를 효과적으로 다루기 위해 저자는 함수형 프로그래밍을 세 가지 기준으로 분류한다.
액션(Action), 계산(Calculator), 데이터(Data)


액션(Action)은 부르는 시점에 따라 다른 동작을 하는 즉, 부르는 시점에 의존을 하는 동작을 의미한다.
책에서는 예시로 이메일을 보내는 행위를 든다.
언제, 몇 번 보냈는지에 따라 받는 이의 메일(데이터)가 변할 수 있다는 것.(예시로 발송 시간 등)
특징:	01. 시간이 지남에 따라 안전하게 상태를 바꿀 수 있는 방법
	02. 순서를 보장하는 방법
	03. 액션이 정확히 한 번만 실행되게 보장하는 방법

계산(Calculator)은 입력한 값에 대해 일정한 리턴을 하는 것을 의미하고, 언제 어떤 요청을 하던 인자가 같다면 항상 같은 리턴을 주는 것을 의미한다.
외부에 영향을 주지도 않고, 테스트하기 쉬우며 몇 번을 불러도 안전하다.
책에서는 예시로 sum() 함수를 들었다.
언제 값을 넣든 1, 2, 3을 넣으면 무조건 6이 리턴된다.
특징:	01. 정확성을 위한 정적 분석
	02. 소프트웨어에서 쓸 수 있는 수학적 지식
	03. 테스트 전략

데이터(data)는 이벤트에 의한 사실을 기록한 것이라고 한다.
실행하는 코드처럼 복잡하지 않기에 다른 것과 구분되고, 알아보기 쉬운 속성으로 되어 있으며 그 자체로 가치가 있다.
같은 데이터를 여러 형태로 해석할 수 있다.
특징:	01. 효율적으로 접근하기 위해 데이터를 구성하는 방법
	02. 데이터를 보관하기 위한 기술
	03. 데이터를 이용해 중요한 것을 발견하는 원칙

또한 액션보다 계산이 사용하기 쉽고, 계산보다 데이터를 사용하는 것이 쉽다고 한다.
예시로 데이터를 저장하고 조회해온다고 하면,
호출 받아 동작하는 서비스 로직의 한 트랜잭션(특정 리턴을 위해 동작하는 프로세스의 한 단위)을 액션으로 치고, 같은 값을 넣으면 같은 데이터를 저장, 조회하는 로직을 계산으로 치며
, 그 인자와 리턴값, 필요에 의하면 DTO를 데이터로 치는 것 같다.
	ㄴ 이 예시에 대해서 처음에는 만족했지만 나중에 새로운 고민이 생겼다.
	만약 인자 데이터에 데이터의 기본 키가 포함되어 있고 똑같이 INSERT, CREATE 를 해주는 로직을 탄다면 기본키 중복 예외를 뱉어낼텐데, 이는 계산이라고 할수 있는가?
		ㄴ 같은 키의 데이터가 있다는 기준하에 그 이후에 실행되는 하나의 액션이 아닌가?
		ㄴ 이는 DB에 대한 공부가 부족했던 것으로, 직접적으로 기본키는 건드리지 않는 것이 원칙이다.
		ㄴ 클라이언트는 기본키에 대하여 건드릴 수 있는 권한이 없다, 기본키는 데이터를 잘 관리하기 위한 필드이다.


※※ 액션, 계산, 데이터를 구분하면 어떤 장점이 있나요?
이렇게 액션, 계산, 데이터로 구분하는 함수형 프로그래밍은 요즘 유행하는 분산 시스템에 잘 어울리는 장점이 있다고 한다.
※ 분산 시스템 규칙 3가지
ㄴ 01. 메세지 순서가 바뀔 수 있다.
ㄴ 02. 메세지는 한 번 이상 도착 할 수도 있고 도착하지 않을 수도 있다.
ㄴ 03. 응답을 받지 못하면 무슨 일이 생겼는지 알 수 없다.
이는 함수형 프로그래밍이 단순한 트렌드가 아니라 오랫동안 쌓아온 수학 지식을 기반으로 하는 프로그래밍 패러다임 임을 의미하고, 
최근 늘어난 여러 기기 간의 통신을 담당하는 복잡한 소프트웨어에서 더욱 각광받게 되었다고 한다.

특히 시간에 따라 바뀌는 값을 리모델링 할 때 동작 방법을 이해하고, 실행 시점이나 횟수에 의존하는 코드를 없앤다면, 코드를 이해하기 더 쉬울 것이다.


※※ 함수형 사고가 무엇인가요?
함수형 사고는 함수형 프로그래머가 소프트웨어 문제를 해결하기 위해 사용하는 기술과 생각이라고 한다.
함수형 사고에서 중요한 개념이 두 가지 있는데, (액션, 계산, 데이터)로 잘 분리하여 파악하는 것과 일급 추상(first-class abstraction) 이다.
특히 액션, 계산, 데이터로 구분하여 리팩터링(Refactoring) 하는 방법 등을 다룰 것이라고 책이 말했다.
그리고 일급 추상은 재사용 되는 함수의 명을 어떻게 짓고 어떻게 쓰며 남용하지 않게 사용하는 방법을 설명할 것이라고 한다.
또 마지막에는 설계 관점에서 반응형 아키텍처(Reactive architecture)와 어니언 아키텍처(Onion architecture) 를 일급 추상과 연결해서 설명할 것이라고 한다.
